<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title class="room-title" slot="primary">
      Friends
    </ion-title>
    <ion-icon name="people" size="large" slot="end"></ion-icon>
  </ion-toolbar>
</ion-header>

<ion-content padding color="dark">
  <ion-card color="tertiary">
    <ion-card-header>
      <ion-card-title>Your friends</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div *ngIf="myFriends.length > 0; else noFriends">
        <ng-container *ngFor="let friend of myFriends">
          <ion-item-sliding>
            <ion-item color="primary">
              <ion-avatar slot="start">
                <img
                  *ngIf="!friend.pictureUrl; else hasPicture"
                  [src]="'https://api.adorable.io/avatars/285/' + friend.email"
                />
                <ng-template #hasPicture>
                  <img [src]="friend.pictureUrl" />
                </ng-template>
              </ion-avatar>
              <ion-label>{{ friend.nickname }}</ion-label>
            </ion-item>
            <ion-item-options>
              <ion-item-option color="danger" (click)="removeFriend(friend)">
                <ion-icon slot="start" name="trash"></ion-icon>
                Remove
              </ion-item-option>
            </ion-item-options>
          </ion-item-sliding>
        </ng-container>
      </div>
      <ng-template #noFriends>
        <div>
          You don't have friend yet ;)
        </div>
      </ng-template>
    </ion-card-content>
  </ion-card>

  <ion-card color="tertiary">
    <ion-card-header>
      <ion-card-title>Add Friends</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-item color="tertiary">
        <ion-label>
          Search by:
        </ion-label>
        <ion-select [(ngModel)]="selectedSearch">
          <ion-select-option *ngFor="let search of searchBy">{{
            search
          }}</ion-select-option>
        </ion-select>
        <ion-input
          type="text"
          placeholder="{{ selectedSearch }}"
          [(ngModel)]="searchString"
        ></ion-input>
      </ion-item>
      <ion-button class="search-friend-button" (click)="searchSomeoneClick()">
        <ion-icon name="search"></ion-icon> Search
      </ion-button>

      <p *ngIf="noFriendFound">
        We don't found the guy you search, or he is already in your friends
      </p>
      <ion-list
        class="friends-list background-primary"
        *ngIf="display_possible_friend_list"
      >
        <ng-container *ngFor="let friend of possible_friend_selectable">
          <app-user-item
            [SelectableUser]="friend"
            [canSelect]="true"
          ></app-user-item>
        </ng-container>
      </ion-list>
      <ion-button
        color="secondary"
        *ngIf="display_possible_friend_list"
        (click)="addToMyFriend()"
        >Add</ion-button
      >
    </ion-card-content>
  </ion-card>
  <ion-card *ngIf="IsMobile" color="tertiary">
    <ion-card-content>
      <ion-button size="full" color="secondary" (click)="onClickSuggestFriend()"
        >Suggest me friend</ion-button
      >
      <ion-progress-bar
        *ngIf="displayLoader"
        type="indeterminate"
      ></ion-progress-bar>
      <p *ngFor="let pfriend of suggested_friend">
        Possible friend: {{ pfriend.nickname }}
        <ion-button (click)="addSuggestedFriend(pfriend)">Add</ion-button>
      </p>
    </ion-card-content>
  </ion-card>
</ion-content>
